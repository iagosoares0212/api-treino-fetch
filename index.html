<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Lista de Posts</title>
</head>

<body>
  <h1>Posts</h1>
  <!-- Lista onde vamos renderizar os posts vindos da API -->
  <ul id="lista-posts"></ul>
  <h2>Novo Post</h2>
  <!-- Campo de texto para digitar o título do post -->
  <input type="text" id="titulo" placeholder="Título do post">
  <!-- Botão que chama a função de criar post -->
  <button onclick="criarPost()">Adicionar</button>

  <script>

    const API_URL = 'http://localhost:3000/posts';

    function carregarPosts() {
      fetch(API_URL)
        .then(res => res.json())
        .then(posts => {
          const lista = document.getElementById('lista-posts');
          lista.innerHTML = '';

          posts.forEach(post => {
            const li = document.createElement('li');
            li.textContent = post.title + ' ';

            const btnExcluir = document.createElement('button');
            btnExcluir.textContent = 'Excluir';
            btnExcluir.onclick = () => {
              fetch(`${API_URL}/${post.id}`, { method: 'DELETE' })
                .then(() => carregarPosts())
                .catch(err => console.error('Erro ao excluir post:', err));
            };

            li.appendChild(btnExcluir);
            lista.appendChild(li);
          });
        })
        .catch(err => console.error('Erro ao carregar posts:', err));
    }

    function criarPost() {
      const titulo = document.getElementById('titulo').value.trim();
      if (!titulo) {
        alert('Digite um título antes de enviar!');
        return;
      }

      fetch(API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          title: titulo,
          body: 'Post criado via fetch',
          userId: 1
        })
      })
        .then(res => res.json())
        .then(data => {
          console.log('Post criado:', data);
          document.getElementById('titulo').value = '';
          carregarPosts();
        })
        .catch(err => console.error('Erro ao criar post:', err));
    }

    carregarPosts();

  </script>
</body>

</html>